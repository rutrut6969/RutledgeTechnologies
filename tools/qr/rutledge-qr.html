<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex, nofollow, noarchive" />
    <title>Rutledge QR Code Generator</title>
    <!-- Brand: Tech Blue #1F3A93, Modern White #F8F9FB, Slate Black #2B2E34, Accent Green #3DBE8B, Soft Gray #E1E3E8 -->
    <style>
      :root {
        --blue: #1f3a93;
        --white: #f8f9fb;
        --black: #2b2e34;
        --green: #3dbe8b;
        --soft: #e1e3e8;
      }
      html,
      body {
        margin: 0;
        background: var(--white);
        color: var(--black);
        font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Helvetica,
          Arial, sans-serif;
      }
      .wrap {
        max-width: 980px;
        margin: 40px auto;
        padding: 24px;
        border-radius: 20px;
        background: #fff;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.06);
      }
      h1 {
        font-size: 28px;
        margin: 0 0 4px;
        color: var(--blue);
      }
      p.sub {
        margin: 0 0 24px;
        color: #4b5563;
      }
      .grid {
        display: grid;
        gap: 18px;
        grid-template-columns: 1.2fr 0.8fr;
        align-items: start;
      }
      .panel {
        padding: 16px;
        border: 1px solid var(--soft);
        border-radius: 16px;
        background: #fff;
      }
      label {
        display: block;
        font-size: 13px;
        margin: 8px 0 6px;
        color: #374151;
      }
      input[type="text"],
      input[type="number"],
      input[type="color"] {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid var(--soft);
        border-radius: 12px;
        font-size: 14px;
        background: #fff;
      }
      input[type="file"] {
        width: 100%;
      }
      .row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      .actions {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        margin-top: 14px;
      }
      button {
        appearance: none;
        border: 0;
        background: var(--blue);
        color: #fff;
        padding: 10px 14px;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 8px 18px rgba(31, 58, 147, 0.25);
      }
      button.secondary {
        background: var(--green);
        box-shadow: 0 8px 18px rgba(61, 190, 139, 0.25);
      }
      button.ghost {
        background: #fff;
        color: var(--blue);
        border: 1px solid var(--soft);
        box-shadow: none;
      }
      .preview {
        display: flex;
        align-items: center;
        justify-content: center;
        background: repeating-conic-gradient(
          from 0deg,
          #f3f4f6 0 25%,
          #e5e7eb 0 50%
        );
        background-size: 24px 24px;
        border-radius: 16px;
        min-height: 300px;
      }
      .preview img {
        max-width: 100%;
        height: auto;
        border-radius: 12px;
      }
      .help {
        font-size: 12px;
        color: #6b7280;
      }
      .badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 999px;
        background: var(--soft);
        color: #374151;
        font-size: 12px;
        margin-left: 6px;
      }
      .footer {
        margin-top: 18px;
        font-size: 12px;
        color: #6b7280;
      }
      @media (max-width: 900px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  </head>
  <body>
    <div class="wrap">
      <h1>
        Rutledge QR Code Generator
        <span class="badge">Logo overlay + brand colors</span>
      </h1>
      <p class="sub">
        Create a high‑contrast, mobile‑friendly QR that links to your site, with
        your logo in the center. Exports as PNG.
      </p>

      <div class="grid">
        <!-- Controls -->
        <div class="panel">
          <label>Destination URL</label>
          <input
            id="url"
            type="text"
            value="https://rutledgetechnologies.com"
          />

          <div class="row">
            <div>
              <label>Dark (modules) color</label>
              <input id="darkColor" type="color" value="#1F3A93" />
            </div>
            <div>
              <label>Light (background) color</label>
              <input id="lightColor" type="color" value="#F8F9FB" />
            </div>
          </div>

          <div class="row">
            <div>
              <label>Output size (px)</label>
              <input
                id="size"
                type="number"
                min="256"
                max="2048"
                step="64"
                value="1024"
              />
            </div>
            <div>
              <label>Quiet zone (%)</label>
              <input
                id="quiet"
                type="number"
                min="4"
                max="16"
                step="1"
                value="8"
              />
            </div>
          </div>

          <div class="row">
            <div>
              <label>Logo (PNG/JPG/SVG recommended as PNG)</label>
              <input id="logoFile" type="file" accept="image/*" />
            </div>
            <div>
              <label>Logo size (% of QR)</label>
              <input
                id="logoScale"
                type="number"
                min="10"
                max="35"
                step="1"
                value="22"
              />
            </div>
          </div>

          <div class="row">
            <div>
              <label>Logo shape</label>
              <select id="logoShape">
                <option value="rounded" selected>Rounded square</option>
                <option value="circle">Circle</option>
                <option value="none">No background</option>
              </select>
            </div>
            <div>
              <label>Show placeholder “RT” if no logo</label>
              <select id="placeholder">
                <option value="yes" selected>Yes</option>
                <option value="no">No</option>
              </select>
            </div>
          </div>

          <div class="actions">
            <button id="generate">Generate</button>
            <button class="secondary" id="download">Download PNG</button>
            <button class="ghost" id="scanTip" type="button">Scan-tip</button>
          </div>

          <p class="help">
            Tips: Use error‑correction <b>H</b> (built‑in), keep high contrast,
            and avoid covering more than ~25% with your logo. Increase quiet
            zone if you add a larger logo.
          </p>
        </div>

        <!-- Preview -->
        <div class="panel preview">
          <img id="out" alt="QR preview will appear here" />
        </div>
      </div>

      <div class="footer">
        Built for Rutledge Technologies. Colors default to Tech Blue and Modern
        White. Tweak as needed.
      </div>
    </div>

    <div
      id="qr-source"
      style="position: absolute; left: -9999px; top: -9999px"
    ></div>

    <script>
      const els = {
        url: document.getElementById("url"),
        dark: document.getElementById("darkColor"),
        light: document.getElementById("lightColor"),
        size: document.getElementById("size"),
        quiet: document.getElementById("quiet"),
        logoFile: document.getElementById("logoFile"),
        logoScale: document.getElementById("logoScale"),
        logoShape: document.getElementById("logoShape"),
        placeholder: document.getElementById("placeholder"),
        generate: document.getElementById("generate"),
        download: document.getElementById("download"),
        out: document.getElementById("out"),
        src: document.getElementById("qr-source"),
        scanTip: document.getElementById("scanTip"),
      };

      let logoDataUrl = null;

      els.logoFile.addEventListener("change", () => {
        const f = els.logoFile.files && els.logoFile.files[0];
        if (!f) {
          logoDataUrl = null;
          return;
        }
        const reader = new FileReader();
        reader.onload = (e) => {
          logoDataUrl = e.target.result;
        };
        reader.readAsDataURL(f);
      });

      function drawRoundedRect(ctx, x, y, w, h, r) {
        const rad = Math.min(r, w / 2, h / 2);
        ctx.beginPath();
        ctx.moveTo(x + rad, y);
        ctx.arcTo(x + w, y, x + w, y + h, rad);
        ctx.arcTo(x + w, y + h, x, y + h, rad);
        ctx.arcTo(x, y + h, x, y, rad);
        ctx.arcTo(x, y, x + w, y, rad);
        ctx.closePath();
      }

      async function generateQR() {
        // Clear previous
        els.src.innerHTML = "";

        const size = Math.max(
          256,
          Math.min(2048, parseInt(els.size.value) || 1024)
        );
        const padPct = Math.max(
          4,
          Math.min(16, parseInt(els.quiet.value) || 8)
        );
        const pad = Math.round((size * padPct) / 100);

        // Create QR (qrcode.js)
        const qrcode = new QRCode(els.src, {
          text: (els.url.value || "").trim(),
          width: size,
          height: size,
          colorDark: els.dark.value || "#000000",
          colorLight: els.light.value || "#FFFFFF",
          correctLevel: QRCode.CorrectLevel.H,
        });

        // Wait for canvas to appear
        await new Promise((res) => setTimeout(res, 30));
        const baseCanvas = els.src.querySelector("canvas");
        if (!baseCanvas) {
          alert("QR render failed");
          return;
        }

        // Composite with quiet zone
        const final = document.createElement("canvas");
        final.width = size + pad * 2;
        final.height = size + pad * 2;
        const ctx = final.getContext("2d");
        // background
        ctx.fillStyle = els.light.value || "#FFFFFF";
        ctx.fillRect(0, 0, final.width, final.height);
        // draw QR
        ctx.drawImage(baseCanvas, pad, pad);

        // Draw logo or placeholder
        const scale =
          Math.max(10, Math.min(35, parseInt(els.logoScale.value) || 22)) / 100;
        const logoSize = Math.round(
          Math.min(final.width, final.height) * scale
        );
        const cx = Math.round(final.width / 2 - logoSize / 2);
        const cy = Math.round(final.height / 2 - logoSize / 2);

        function drawBgShape() {
          const shape = els.logoShape.value;
          const bg = "#FFFFFF";
          if (shape === "none") return;
          ctx.save();
          ctx.fillStyle = bg;
          ctx.globalAlpha = 0.98;
          if (shape === "circle") {
            ctx.beginPath();
            ctx.arc(
              final.width / 2,
              final.height / 2,
              logoSize / 2 + 6,
              0,
              Math.PI * 2
            );
            ctx.closePath();
            ctx.fill();
          } else {
            drawRoundedRect(
              ctx,
              cx - 6,
              cy - 6,
              logoSize + 12,
              logoSize + 12,
              14
            );
            ctx.fill();
          }
          ctx.restore();
          // subtle border in accent green
          ctx.save();
          ctx.strokeStyle =
            getComputedStyle(document.documentElement).getPropertyValue(
              "--green"
            ) || "#3DBE8B";
          ctx.lineWidth = 2;
          if (els.logoShape.value === "circle") {
            ctx.beginPath();
            ctx.arc(
              final.width / 2,
              final.height / 2,
              logoSize / 2 + 6,
              0,
              Math.PI * 2
            );
            ctx.stroke();
          } else if (els.logoShape.value !== "none") {
            drawRoundedRect(
              ctx,
              cx - 6,
              cy - 6,
              logoSize + 12,
              logoSize + 12,
              14
            );
            ctx.stroke();
          }
          ctx.restore();
        }

        async function drawLogo() {
          if (logoDataUrl) {
            return new Promise((resolve) => {
              const img = new Image();
              img.onload = () => {
                drawBgShape();
                // draw image centered
                ctx.save();
                // clip to shape if requested
                if (els.logoShape.value === "circle") {
                  ctx.beginPath();
                  ctx.arc(
                    final.width / 2,
                    final.height / 2,
                    logoSize / 2,
                    0,
                    Math.PI * 2
                  );
                  ctx.closePath();
                  ctx.clip();
                } else if (els.logoShape.value === "rounded") {
                  ctx.beginPath();
                  drawRoundedRect(ctx, cx, cy, logoSize, logoSize, 10);
                  ctx.clip();
                }
                ctx.drawImage(img, cx, cy, logoSize, logoSize);
                ctx.restore();
                resolve();
              };
              img.onerror = () => {
                resolve();
              };
              img.src = logoDataUrl;
            });
          } else if (els.placeholder.value === "yes") {
            // Placeholder medallion with RT
            drawBgShape();
            const grad = ctx.createLinearGradient(
              cx,
              cy,
              cx + logoSize,
              cy + logoSize
            );
            grad.addColorStop(0, "#1F3A93");
            grad.addColorStop(1, "#3DBE8B");
            if (els.logoShape.value === "circle") {
              ctx.beginPath();
              ctx.arc(
                final.width / 2,
                final.height / 2,
                logoSize / 2,
                0,
                Math.PI * 2
              );
              ctx.closePath();
              ctx.fillStyle = grad;
              ctx.fill();
            } else if (els.logoShape.value === "rounded") {
              ctx.beginPath();
              drawRoundedRect(ctx, cx, cy, logoSize, logoSize, 10);
              ctx.fillStyle = grad;
              ctx.fill();
            } else {
              // no background chosen
            }
            // text
            ctx.save();
            ctx.fillStyle = "#ffffff";
            ctx.font = `bold ${Math.round(
              logoSize * 0.42
            )}px system-ui,Segoe UI,Arial`;
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText("RT", final.width / 2, final.height / 2 + 2);
            ctx.restore();
          }
        }

        await drawLogo();

        els.out.src = final.toDataURL("image/png");
        els.out.dataset.href = els.out.src; // for download
      }

      function downloadPNG() {
        const href = els.out.dataset.href;
        if (!href) {
          alert("Generate the QR first.");
          return;
        }
        const a = document.createElement("a");
        a.href = href;
        a.download = "rutledge-qr.png";
        document.body.appendChild(a);
        a.click();
        a.remove();
      }

      function showScanTip() {
        alert(
          "Scan tips: 1) Keep strong contrast (dark modules on light background). 2) Use error correction H (enabled). 3) Keep logo <= ~25% of QR. 4) Leave a quiet zone (8–12%). 5) Test on iPhone + Android at arm’s length."
        );
      }

      els.generate.addEventListener("click", generateQR);
      els.download.addEventListener("click", downloadPNG);
      els.scanTip.addEventListener("click", showScanTip);

      // Auto-generate on load
      window.addEventListener("load", generateQR);
    </script>
  </body>
</html>
